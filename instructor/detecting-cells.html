<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to bioimage analysis and CellProfiler: Identifying secondary &amp; tertiary objects</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/DBI/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/DBI/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/DBI/favicon-16x16.png"><link rel="manifest" href="../favicons/DBI/site.webmanifest"><link rel="mask-icon" href="../favicons/DBI/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav DBI"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="DBI-logo" alt="DBI-INFRA" src="../assets/images/DBI-logo.svg"></div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>


      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../detecting-cells.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav DBI" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="DBI-INFRA" src="../assets/images/DBI-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to bioimage analysis and CellProfiler
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to bioimage analysis and CellProfiler
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to bioimage analysis and CellProfiler
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 43%" class="percentage">
    43%
  </div>
  <div class="progress DBI">
    <div class="progress-bar DBI" role="progressbar" style="width: 43%" aria-valuenow="43" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../detecting-cells.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="dataset.html">1. Introduction to the BBBC021 dataset</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="introduction.html">2. Reading images</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="detecting-nuclei.html">3. Identifying primary objects</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Identifying secondary &amp; tertiary objects
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#from-nuclei-to-whole-cells">From nuclei to whole cells</a></li>
<li><a href="#the-identifysecondaryobjects-module">The IdentifySecondaryObjects module</a></li>
<li><a href="#identifying-cytoplasm">Identifying cytoplasm</a></li>
<li><a href="#conclusions">Conclusions</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="measure-features.html">5. Measuring object intensity and shape</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="reproducibility.html">6. Reproducibility in CellProfiler</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="bonus.html">7. Bonus: visualising features</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/detecting-nuclei.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/measure-features.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/detecting-nuclei.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Identifying primary
        </a>
        <a class="chapter-link float-end" href="../instructor/measure-features.html" rel="next">
          Next: Measuring object...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Identifying secondary &amp; tertiary objects</h1>
        <p>Last updated on 2026-01-23 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/detecting-cells.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we detect whole cells once we have identified nuclei?</li>
<li>What is the differences between detecting primary, secondary, and
tertiary objects?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Use <strong>IdentifySecondaryObjects</strong> to segment whole cells
from an actin image.</li>
<li>Understand how secondary objects depend on primary objects.</li>
<li>Learn how propagation-based segmentation expands from nuclei to cell
edges.</li>
<li>Create a cell object set suitable for per-cell measurements.</li>
<li>Use <strong>IdentifyTertiaryObjects</strong> to create cytoplasm
masks.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="from-nuclei-to-whole-cells">From nuclei to whole cells<a class="anchor" aria-label="anchor" href="#from-nuclei-to-whole-cells"></a></h2>
<hr class="half-width"><p>In the previous section, we identified nuclei as <strong>primary
objects</strong>. This gives us ‚Äúseed‚Äù objects: one nucleus per
cell.</p>
<p>However, many biologically interesting measurements (e.g.¬†cell area,
shape and cytoplasmic fluorescence) require us to segment the
<strong>whole cell</strong>. This is often more challenging than nuclei
segmentation because:</p>
<ul><li>cytoplasm and boundaries can be <strong>fainter</strong> than
nuclei,</li>
<li>neighboring cells may <strong>touch</strong> or overlap,</li>
<li>staining can be <strong>uneven</strong> across the cell body.</li>
</ul><p>To tackle this, CellProfiler provides
<code>IdentifySecondaryObjects</code>, which grows secondary objects
outward from nuclei using information from another image (here an actin
channel). This approach helps prevent ambiguous assignments of boundary
pixels by ensuring each cell is linked to exactly one starting
nucleus.</p>
</section><section><h2 class="section-heading" id="the-identifysecondaryobjects-module">The IdentifySecondaryObjects module<a class="anchor" aria-label="anchor" href="#the-identifysecondaryobjects-module"></a></h2>
<hr class="half-width"><p>Add a new module via <strong>+ Add</strong> ‚Üí <strong>Object
Processing</strong> ‚Üí <strong>IdentifySecondaryObjects</strong>.</p>
<p>You should now see a module where you need to specify:</p>
<ol style="list-style-type: decimal"><li>which primary objects act as ‚Äúseeds‚Äù (nuclei),</li>
<li>which image contains cell boundary information (actin),</li>
<li>how to determine where each cell ends (thresholding + method),</li>
<li>how to handle cells touching the image border.</li>
</ol><div class="section level3">
<h3 id="step-1-choose-primary-input-objects">Step 1: choose primary input objects<a class="anchor" aria-label="anchor" href="#step-1-choose-primary-input-objects"></a></h3>
<p>Set <code>Select the input objects</code> (or similarly named
setting) to <code>Nuclei</code> or the name you set in the previous
lesson. This tells CellProfiler that each cell object should be grown
outward from one nucleus.</p>
</div>
<div class="section level3">
<h3 id="step-2-choose-the-correct-input-image-actin">Step 2: choose the correct input image (actin)<a class="anchor" aria-label="anchor" href="#step-2-choose-the-correct-input-image-actin"></a></h3>
<p>Set <code>Select the input image</code> to your actin (or
cytoplasmic) channel, e.g. <code>Actin</code> (or whatever name you
assigned in <code>NamesAndTypes</code>).</p>
<p>The channel should contain relatively strong signal across the cell
body and/or along the cell boundary.</p>
<div id="checking-the-actin-image" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="checking-the-actin-image" class="callout-inner">
<h3 class="callout-title">Checking the actin image</h3>
<div class="callout-content">
<p>Using Test Mode, inspect a few images:</p>
<ul><li>Can you see whole cell bodies?</li>
<li>Are neighboring cells separable?</li>
<li>Is the background reasonably dark?</li>
</ul><p>If not, what issues do you observe?</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you find the contrast too dim to see the channel well, you can
increase the contrast. You can do so either by right clicking &gt;
<code>Adjust Contrast</code>, or by selecting
<code>Subplots &gt; (Object name) outlines &gt; Adjust Contrast</code>.
Then, select <code>Log normalized</code> and a
<code>normalization factor</code> that you deem suitable, the click
<code>Apply to all</code>. <img src="../fig/secondary_contrast.png" alt="Screenshots showing that contrast be adjusted using Subplots &gt; (Object name) outlines &gt; Adjust Contrast and selecting Log normalized and a normalization factor in the range of 2-5, the clicking Apply to all." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Compared to nuclei, cell boundaries are often less easily
distinguished. We can see that the actin channel does increase at cell
junctions, which should help in segmenting the cells in later steps. But
it is important to keep in mind that any segmentation will not be
perfect here: after all, where would you draw the boundaries by hand?
<img src="../fig/secondary_actin_dna.png" alt="Picture of cells, with DNA stain shown in blue and actin stain shown in gray. While nuclei are fairly well separated, cell boundaries are touching in many places and are not easily distinguished." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-3-choose-a-method-to-identify-secondary-objects">Step 3: choose a method to identify secondary objects<a class="anchor" aria-label="anchor" href="#step-3-choose-a-method-to-identify-secondary-objects"></a></h3>
<p>Now we will use <code>IdentifySecondaryObjects</code> to segment
cells. Many of the options are the same as in
<code>IdentifyPrimaryObjects</code>, but the most important difference
is the presence of
<code>Select the method to identify the secondary objects</code> option.
We encourage you to read their descriptions in CellProfiler by clicking
the <code>?</code> symbol, but most often it is set to
<code>Propagation</code>. To see why, let‚Äôs see what happens when we try
segmenting cells with either method!</p>
<div id="optional-challenge-explore-methods" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="optional-challenge-explore-methods" class="callout-inner">
<h3 class="callout-title">Optional challenge: explore methods</h3>
<div class="callout-content">
<p>Try two different methods (e.g.¬†propagation vs watershed gradient).
How do the resulting cell boundaries differ?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Comparing methods </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>As with the segmentation of nuclei, getting cell segmentation right
can be tricky. Often, starting with <code>propagation</code> as method
is a good starting point, because watershed can expand into neighboring
cells (see below). But you can certainly find areas of the image where
the reverse is true. This means that, once again, choices should be made
carefully. <img src="../fig/secondary_watershed_propagation.png" alt="Comparing two methods of identifying cell boundaries: watershed and propagation. Using watershed, some cell boundaries spill over into adjacent cells, leading to incorrect cell masks." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-4-choose-a-threshold-strategy-and-threshold-method">Step 4: choose a threshold strategy and threshold method<a class="anchor" aria-label="anchor" href="#step-4-choose-a-threshold-strategy-and-threshold-method"></a></h3>
<p>Much like when segmenting nuclei, the
<code>IdentifySecondaryObjects</code> module allows us to fine-tune our
segmentation by changing the thresholding strategy and method. As
before, the best choice depends on illumination and staining
consistency. While <strong>Minimum Cross-Entropy</strong> (right) is the
default thresholding method, <strong>Otsu</strong> (left) can often also
yield good masks and makes a bit fewer assumptions about your image. For
this dataset they perform very similarly, except that Minimum
Cross-Entropy does slightly better at detecting protrusions such as in
the below image.</p>
<figure><img src="../fig/secondary_otsu_me.png" alt="Side-by-side of Otsu and minimum cross-entropy thresholding results." class="figure mx-auto d-block"></figure><div id="challenge-biological-pitfalls" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-biological-pitfalls" class="callout-inner">
<h3 class="callout-title">Challenge: biological pitfalls</h3>
<div class="callout-content">
<p>Think about the assumptions CellProfiler is making in its
identification of secondary objects. Can you think of biological samples
where these assumptions may not be met? Discuss with your neighbor.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>CellProfiler identifies cells by expanding outwards from a nucleus.
This assumes that <strong>each cell only has exactly one
nucleus</strong> in the same plane. When imaging hepatocytes, for
example, this can prove problematic: they often contain more than one
nucleus. Equally, if we were imaging cells in suspension, we would have
to make sure than we <strong>capture the nucleus accurately in
3D</strong> and expand the cell in 3D space too. And lastly, red blood
cells do not even have a nucleus, so this method would not work for them
either!</p>
<p>Other pitfalls include <strong>mitotic/meiotic cells</strong>: from
when on do we term a splitting cell as two cells? When the two nuclei
have budded off, or when the membrane is fully split? CellProfiler
cannot answer these questions for us, instead, we must consider these
biological complexities when designing our analysis pipeline to not
yield nonsensical data down the line.</p>
</div>
</div>
</div>
</div>
<p>Once you are happy with the result, make sure to check the following
options:</p>
<ol style="list-style-type: decimal"><li>Fill holes in identified objects: Yes</li>
<li>Discard secondary objects touching the border of the image: Yes</li>
<li>Discard the associated primary objects: Yes</li>
</ol><p>And finally, name the new primary objects thus filtered,
e.g.¬†<code>Nuclei_Filtered</code>.</p>
</div>
</section><section><h2 class="section-heading" id="identifying-cytoplasm">Identifying cytoplasm<a class="anchor" aria-label="anchor" href="#identifying-cytoplasm"></a></h2>
<hr class="half-width"><p>You have now created whole-cell objects from nuclei seeds and an
actin image. Well done! üéâ</p>
<p>With nuclei and cells in hand, we can create one last object: the
cytoplasm. Fortunately, this one is easy:</p>
<blockquote>
<p>Cytoplasm = Cell - Nucleus</p>
</blockquote>
<p>To do this, add the <code>IdentifyTertiaryObjects</code> module and
select what you think are the correct options.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Suggested settings </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<ul><li>Larger objects: cells identified with
<code>IdentifySecondaryObjects</code>
</li>
<li>Smaller objects: nuclei filtered in
<code>IdentifySecondaryObjects</code>
</li>
<li>Name: e.g.¬†<code>Cytoplasm</code>
</li>
<li>Shrink smaller object prior to subtraction: <code>Yes</code>
(default)</li>
</ul></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a></h2>
<hr class="half-width"><p>Finally, we have created all masks we need and can move on to measure
things!</p>
<div class="section level3">
<h3 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a></h3>
<p>Did you get stuck with one of the steps? Download a working version
of the pipeline here:</p>
<p><a href="../data/pipeline_2.cppipe" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
pipeline</a></p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you are using Firefox, you have to right click the button and
select <code>Save Link As...</code>.</p>
</div>
</div>
</div>
<p>After downloading the pipeline, you can compare it to yours for
troubleshooting. To do so, first open a new CellProfiler window. Then,
import this pipeline in CellProfiler by clicking on <code>File</code>
&gt; <code>Import</code> &gt; <code>Pipeline from File</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>Secondary objects (cells) are typically grown from primary objects
(nuclei) using a cytoplasmic/cell-boundary stain (here: actin).</li>
<li>Filtering border-touching nuclei helps avoid partial cells and
misleading measurements.</li>
<li>The most important settings in
<strong>IdentifySecondaryObjects</strong> are the identification method
and thresholding choices, which strongly affect whether cells merge or
fragment.</li>
<li>Tertiary objects (cytoplasm) are a subtraction of nuclei from the
cell mask.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/detecting-nuclei.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/measure-features.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/detecting-nuclei.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Identifying primary
        </a>
        <a class="chapter-link float-end" href="../instructor/measure-features.html" rel="next">
          Next: Measuring object...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/detecting-cells.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/" class="external-link">Source</a></p>
        <p>
        <a href="../citation.html">Cite</a>
        | <a href="mailto:jesko.wagner@sund.ku.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
		</div>
		<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.18.4" class="external-link">sandpaper (0.18.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/jeskowagner/varnish/tree/8da1eb456c7ff3588cefa7583bddc422ae83b3f8" class="external-link">varnish (1.0.9)</a></p>
		</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/detecting-cells.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "CellProfiler, lesson, bioimaging",
  "name": "Identifying secondary &amp;amp; tertiary objects",
  "creativeWorkStatus": "active",
  "url": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/detecting-cells.html",
  "identifier": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/detecting-cells.html",
  "dateCreated": "2026-01-08",
  "dateModified": "2026-01-23",
  "datePublished": "2026-01-23"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

