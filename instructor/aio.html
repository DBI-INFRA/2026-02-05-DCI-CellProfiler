<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to bioimage analysis and CellProfiler: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/DBI/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/DBI/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/DBI/favicon-16x16.png">
<link rel="manifest" href="../favicons/DBI/site.webmanifest">
<link rel="mask-icon" href="../favicons/DBI/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav DBI"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="DBI-logo" alt="DBI-INFRA" src="../assets/images/DBI-logo.svg">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>


      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav DBI" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="DBI-INFRA" src="../assets/images/DBI-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to bioimage analysis and CellProfiler
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to bioimage analysis and CellProfiler
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to bioimage analysis and CellProfiler
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress DBI">
    <div class="progress-bar DBI" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="dataset.html">1. Introduction to the BBBC021 dataset</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="introduction.html">2. Reading images</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="detecting-nuclei.html">3. Identifying primary objects</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="detecting-cells.html">4. Identifying secondary &amp; tertiary objects</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="measure-features.html">5. Measuring object intensity and shape</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="reproducibility.html">6. Reproducibility in CellProfiler</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="bonus.html">7. Bonus: visualising features</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="cellprofiler-analyst.html">8. Advanced: classifying cells in CellProfiler Analyst</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-dataset"><p>Content from <a href="dataset.html">Introduction to the BBBC021 dataset</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/dataset.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the BBBC021 dataset?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get an overview of the research question behind BBBC021.</li>
<li>Understand the file structure.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="the-example-dataset-bbbc021">The example dataset BBBC021<a class="anchor" aria-label="anchor" href="#the-example-dataset-bbbc021"></a>
</h2>
<hr class="half-width">
<p>Welcome! For the next exercise we will use a compact, <a href="https://doi.org/10.1158/1535-7163.MCT-09-1148" class="external-link">well-studied</a>
image set pulled from the <a href="https://bbbc.broadinstitute.org/" class="external-link">Broad Bioimage Benchmark
Collection</a> (BBBC). The collection we are using is BBBC021, which
contains images of MCF7 breast cancer cells treated with a panel of
compounds. You can browse the full dataset here: <a href="https://bbbc.broadinstitute.org/BBBC021" class="external-link uri">https://bbbc.broadinstitute.org/BBBC021</a>.</p>
<p>Why this dataset? Firstly, it is real experimental data used to
discover which compounds change cell morphology and to cluster compounds
by the pathways they perturb. Secondly, it is small and clean enough for
hands-on learning, but biologically rich, so the analyses you build here
translate to real research problems.</p>
<p>What did the experiment involve?</p>
<ul>
<li>Cells: MCF7 (human breast cancer cell line)</li>
<li>Perturbations: 112 small molecules + DMSO control at multiple
concentrations (we will use just two wells for the workshop)</li>
<li>Stains (channels):
<ul>
<li>DAPI: stains DNA / nuclei (channel1)</li>
<li>Phalloidin: stains f‑actin (channel2)</li>
<li>Anti‑β‑tubulin antibody: stains microtubules (channel3)</li>
</ul>
</li>
</ul>
<p>In this workshop, we will focus on comparing cells treated with DMSO
to those treated with <strong>cytochalasin D</strong> (cytoD). It is a
classic actin‑disrupting drug. When actin polymerization is disrupted
you often see cells lose their spread morphology, change shape, and show
altered phalloidin signal. That makes this a great case study for
image‑based phenotyping.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Given what you know about the dataset so far, can you formulate a
research question? Try thinking about questions we may be able to answer
using the images.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>One option is: does cytochalasin D induce a morphological change in
MCF7 cells?</p>
<p>But note that other questions may be interesting too! For example:
does cytoD induce cell death?</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="files-and-metadata">Files and Metadata<a class="anchor" aria-label="anchor" href="#files-and-metadata"></a>
</h3>
<p>Filenames contain the experimental metadata so you do not need a
separate spreadsheet. For example, the file name
<code>cytoD_B07_s1_channel1.tif</code> can be read as</p>
<ul>
<li>Treatment: cytoD</li>
<li>Well: B07</li>
<li>Site: s1 (image field within the well)</li>
<li>Channel: channel1 (DAPI in this dataset)</li>
</ul>
</div>
<div class="section level3">
<h3 id="downloading-sample-data">Downloading sample data<a class="anchor" aria-label="anchor" href="#downloading-sample-data"></a>
</h3>
<p>If you have not yet done so, you will need to download the dataset
now. Click on the button below and unzip the archive to a convenient
location on your computer.</p>
<p><a href="../data/BBBC021_data.zip" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
dataset</a></p>
</div>
<div class="section level3">
<h3 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h3>
<p>Ready to build the analysis pipeline? Proceed to the next section to
open these images in CellProfiler and start measuring the features that
will answer our question.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>BBBC021 is a high-content imaging dataset of MCF7 cells.</li>
<li>File names contain information about treatments and experimental
parameters.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</section></section><section id="aio-introduction"><p>Content from <a href="introduction.html">Reading images</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 17 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we get started in CellProfiler?</li>
<li>How do we teach CellProfiler the structure of our images?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Load images in CellProfiler.</li>
<li>Understand modules for data loading.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="understanding-preprocessing-modules">Understanding preprocessing modules<a class="anchor" aria-label="anchor" href="#understanding-preprocessing-modules"></a>
</h2>
<hr class="half-width">
<p>There are four modules that CellProfiler always uses. In this
episode, we will go through each and show what they are used for.</p>
<div class="section level3">
<h3 id="images">Images<a class="anchor" aria-label="anchor" href="#images"></a>
</h3>
<p>Before we can get started with analyzing our images in CellProfiler,
we need to load them in. Start CellProfiler and see whether you can
figure out how!</p>
<div id="load-the-images-into-cellprofiler" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="load-the-images-into-cellprofiler" class="callout-inner">
<h3 class="callout-title">Load the images into CellProfiler</h3>
<div class="callout-content">
<p>Open CellProfiler and try loading the images into CellProfiler.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Loading images </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>You can drag and drop the two folders, <code>DMSO</code> and
<code>cytoD_0.1</code>, onto the white field in CellProfiler.
Afterwards, it should look something like this: <img src="../fig/images_loaded.png" alt="Screenshot of the CellProfiler `Images` module" class="figure"></p>
</div>
</div>
</div>
</div>
<p>Now that CellProfiler knows where to find our images, we have to tell
it a little bit about what is <em>in</em> the images.</p>
</div>
<div class="section level3">
<h3 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>With the images loaded into CellProfiler, we can now start teaching
CellProfiler what image belongs to which sample. For this, we use the
Metadata module. This module’s purpose is to translate information that
is captured in the file names into information that CellProfiler can
understand.</p>
<p>Get started by clicking on <code>yes</code> for
<code>Extract metadata?</code>, upon which a menu should pop open. This
is what it looks like by default: <img src="../fig/metadata_default.png" alt="Screenshot of the CellProfiler module `Metadata` with default settings" class="figure"></p>
<p>Now, we wish to inform CellProfiler about which image contains what.
To do so, set up the module as follows. <img src="../fig/metadata_regular_expression.png" alt="Screenshot showing metadata module settings" class="figure"></p>
<p>While this regular expression looks complicated, in general they can
be crafted more easily using tools like <a href="https://regex101.com/" class="external-link">regex101.com</a>. Unfortunately, regular
expressions are beyond the scope of this workshop, so feel free to just
copy them from here:</p>
<p><code>^(?P&lt;Treatment&gt;.*)_(?P&lt;Well&gt;[A-P][0-9]{2})_s(?P&lt;Site&gt;[0-9])_channel(?P&lt;ChannelNumber&gt;[0-9])</code></p>
<div id="what-is-happening-here" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="what-is-happening-here" class="callout-inner">
<h3 class="callout-title">What is happening here?</h3>
<div class="callout-content">
<p>The images we are using have names like
<code>cytoD_B07_s1_channel1.tif</code>. We are trying to translate these
names into metadata with this awkward looking expression:
<code>^(?P&lt;Treatment&gt;.*)_(?P&lt;Well&gt;[A-P][0-9]{2})_s(?P&lt;Site&gt;[0-9])_channel(?P&lt;ChannelNumber&gt;[0-9])</code>.</p>
<p>This is an example of a <a href="https://librarycarpentry.github.io/lc-data-intro/01-regular-expressions" class="external-link">regular
expression</a>. If you have not heard of regular expressions before,
they represent a powerful way of pattern matching. Here, we use it to
decode the file names.</p>
<p>You do not have to understand all the parts, but can you guess which
part of the file name will match which part of the regular
expression?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Regular expressions in CellProfiler </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>We can break up our file names by underscores. For example,
<code>cytoD_B07_s1_channel1.tif</code> can be read as</p>
<ul>
<li>Treatment: <code>cytoD</code>
</li>
<li>Well: <code>B07</code>
</li>
<li>Site: <code>s1</code> (site is the image number within a well)</li>
<li>Channel: <code>channel1</code>
</li>
</ul>
<p>Using the regular expression, we can extract this information from
each file name automatically, as long as it follows the same naming
convention.</p>
</div>
</div>
</div>
</div>
<p>With this in hand, we can now translate the file names into metadata
that CellProfiler can understand. To see this in action, press the
<code>Update</code> button (top left in the below image), after which
you can see the new columns to the right containing information about
the imaging site, the week of the experiment, the imaged well, and
treatment used.</p>
<figure><img src="../fig/metadata_extracted.png" alt="Screenshot showing the extracted metadata" class="figure mx-auto d-block"></figure>
</div>
</section><section><h2 class="section-heading" id="namesandtypes">NamesAndTypes<a class="anchor" aria-label="anchor" href="#namesandtypes"></a>
</h2>
<hr class="half-width">
<p>This module allows us to rename channel numbers to stain names.
Recall from the <a href="dataset.html">dataset introduction</a> that our
stains are for DNA, actin, and tubulin, imaged in the first, second, and
third channel. To make our lives easier when working with CellProfiler,
we therefore wish to rename the channels to the corresponding stains.
This helps us later when we pick the stain to detect cells from.</p>
<p>If you are working on this workshop as part of our CellProfiler
course, you will have done this yesterday, in which case: give it a go
yourself! But if this is the first time you encounter the
<code>NamesAndTypes</code> module, click on the spoiler below.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Show details </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>The <code>NamedAndTypes</code> module tells CellProfiler which
channel belongs to which stain. Opening the module, we can see the
following defaults: <img src="../fig/namesandtypes_default.png" alt="Screenshot of the NamesAndTypes module with default settings" class="figure"></p>
<p>Recall that in the <code>Metadata</code> module we extracted the
channel number. We can now make use of this information to assign stain
names to the images. To do so, we switch the <code>Assign a name</code>
to <code>Images matching rules</code> (see below) and then assign the
channels to names. You will have to click <code>Add another image</code>
to add a new stain name, filling out the information as in the
screenshot and then clicking <code>Update</code>.</p>
<figure><img src="../fig/namesandtypes_configured.png" alt="Screenshot of the NamesAndTypes module after configuration settings" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="groups">Groups<a class="anchor" aria-label="anchor" href="#groups"></a>
</h2>
<hr class="half-width">
<p>You can leave this module untouched for now. It is intended to
further group images by experimental units, such as batches, plates,
etc. Here, we only have two sets of images and do not need the
additional grouping.</p>
</section><div class="section level1">
<h1 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h1>
<p>To summarize, the preprocessing modules do not make any changes to
the images, but instead translate file and folder names into structures
CellProfiler can understand. As we will see in the next tutorial, this
will be useful once we start working with the images in CellProfiler to
do things like detecting cell boundaries and measure fluorescence
intensity. If you have made it this far - well done! It can feel a bit
overwhelming to get started with CellProfiler and to have it set up
properly, but now that we have it in place we can finally launch into
our analysis.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Load images by dragging/dropping them onto CellProfiler’s
<code>Images</code> module</li>
<li>The <code>Metadata</code> module translates file names to extract
metadata from file names, which will be saved along with your
measurements.</li>
<li>The <code>NamesAndTypes</code> module converts image names to
meaningful names to be used within CellProfiler.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div></section><section id="aio-detecting-nuclei"><p>Content from <a href="detecting-nuclei.html">Identifying primary objects</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/detecting-nuclei.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How does CellProfiler identify objects in an image?</li>
<li>Why do we usually start segmentation with nuclei?</li>
<li>Which parameters matter most for good nucleus segmentation?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand what primary objects are in CellProfiler.</li>
<li>Configure the <strong>IdentifyPrimaryObjects</strong> module to
segment nuclei.</li>
<li>Learn how to assess segmentation quality using the Test Mode
viewer.</li>
<li>Produce a nucleus object set suitable for downstream cell/feature
analysis.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction-why-segment-nuclei-first">Introduction: why segment nuclei first?<a class="anchor" aria-label="anchor" href="#introduction-why-segment-nuclei-first"></a>
</h2>
<hr class="half-width">
<p>In this episode, we will segment <strong>nuclei</strong> as our
<strong>primary objects</strong>. In many microscopy assays, nuclei are
an ideal starting point because they are:</p>
<ul>
<li>
<strong>High contrast</strong> in a DNA channel (bright nuclei on a
dark background), making them easier to separate from non-cell
regions.</li>
<li>
<strong>Present in (almost) every cell</strong>, giving a reliable
“anchor” object for counting cells and linking measurements.</li>
<li>Typically <strong>compact and well-defined</strong>, which helps the
segmentation algorithm succeed even when cell boundaries are faint.</li>
</ul>
<figure><img src="../fig/tubulin_dapi_sidebyside.png" alt="Side by side image of cells stained for microtubules and nuclei. Nuclei are more easily discerned from each other." class="figure mx-auto d-block"><div class="figcaption">Often, identifying cells is easier with a
nuclear rather than an intracellular stain. Left: Cells stained for
microtubules, right: DAPI-stained nuclei.</div>
</figure><p>Once nuclei are correctly identified, we can often use them to guide
later steps like finding whole cells (secondary objects) or cytoplasm
(tertiary objects), and to compute per-cell measurements.</p>
<p>In CellProfiler’s terminology:</p>
<ul>
<li>
<strong>Primary objects</strong> are detected directly from an image
(here: nuclei from the DNA channel).</li>
<li>
<strong>Secondary objects</strong> are grown out from primary
objects (often whole cells).</li>
<li>
<strong>Tertiary objects</strong> are derived from other objects
(often cytoplasm = cell minus nucleus).</li>
</ul></section><section><h2 class="section-heading" id="the-identifyprimaryobjects-module">The IdentifyPrimaryObjects module<a class="anchor" aria-label="anchor" href="#the-identifyprimaryobjects-module"></a>
</h2>
<hr class="half-width">
<p>Add a new module via <strong>+ Add</strong> → <strong>Object
Processing</strong> → <strong>IdentifyPrimaryObjects</strong>.</p>
<figure><img src="../fig/addmodule_primary.png" alt="Screenshots of CellProfiler, showing how to add the IdentifyPrimaryObjects module." class="figure mx-auto d-block"></figure><p>You should now see a module where you need to specify:</p>
<ol style="list-style-type: decimal">
<li>which image to segment,</li>
<li>what to call the resulting objects,</li>
<li>how CellProfiler should separate touching nuclei,</li>
<li>what size and shape constraints to apply,</li>
<li>and (optionally) how to filter out artifacts.</li>
</ol>
<div class="section level3">
<h3 id="step-1-choose-the-correct-input-image">Step 1: choose the correct input image<a class="anchor" aria-label="anchor" href="#step-1-choose-the-correct-input-image"></a>
</h3>
<p>Set <strong>Select the input image</strong> to the DNA/nuclear stain
image (i.e. <code>DNA</code>, if you followed the steps in the <a href="introduction.html#namesandtypes">previous episode</a>).</p>
<p>Set <strong>Name the primary objects to be identified</strong> to
something descriptive like <code>Nuclei</code>.</p>
<div id="confirm-you-are-using-the-correct-channel" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="confirm-you-are-using-the-correct-channel" class="callout-inner">
<h3 class="callout-title">Confirm you are using the correct channel</h3>
<div class="callout-content">
<p>How can you quickly verify that you selected the <strong>DNA</strong>
image (and not actin or tubulin)?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="section level5 accordion-body">
<h5 id="using-interactive-test-mode">Using interactive test mode<a class="anchor" aria-label="anchor" href="#using-interactive-test-mode"></a>
</h5>
<p>One way to verify the image that is being segmented is to use
CellProfiler’s interactive test interface. To do this, first make sure
the eye symbol next to the module is enabled (dark). If it is a disabled
(light grey), click on the eye (step 1 in the figure below). Second,
start test mode and run the first step. A new CellProfiler window will
open, that shows the image that is being segmented next to the
segmentation results. Do the objects in the top left image look like
nuclei? You can zoom in using the magnifying glass (step 4 in figure).
<img src="../fig/primary_visualisedna.png" alt="Screenshots of CellProfiler, showing how to use the test interface to see which channel is being segmented." class="figure"></p>
<p>Nuclei should show as compact, round, and high-contrast objects, as
in the figure above. If you get a different result, make sure to
double-check your settings for the <code>IdentifyPrimaryObjects</code>
and <code>Metadata</code> modules.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-2-set-an-expected-nucleus-diameter-in-pixels">Step 2: set an expected nucleus diameter (in pixels)<a class="anchor" aria-label="anchor" href="#step-2-set-an-expected-nucleus-diameter-in-pixels"></a>
</h3>
<p>CellProfiler needs an approximate size range for objects. Set
<code>Typical diameter of objects, in pixel units (Min, Max)</code> to a
range that matches your nuclei.</p>
<p>This is one of the most important parameters. If the minimum is too
small, you may pick up noise; if the maximum is too small, large nuclei
may be split.</p>
<div id="estimate-nucleus-size" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="estimate-nucleus-size" class="callout-inner">
<h3 class="callout-title">Estimate nucleus size</h3>
<div class="callout-content">
<p>Using a representative image, estimate a reasonable nucleus diameter
range.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Diameter range </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>To estimate nuclei size range, it is good to measure the diameter of
a few nuclei in a representative image. We can do so by using the
measure tool in CellProfiler. From the test interface used in the
previous challenge, we can access the measure tool (step 1 in figure).
Then, by clicking and dragging the cursor (2), we can measure the length
in pixels, which is displayed in the bottom right of the window (3). By
repeating this process for a few nuclei, ideally across a few images, we
can gain a good intuition for typical nuclei diameters.</p>
<p>In this dataset, you could use lower bounds of 10-20 pixels, and
upper bounds of 40-70 pixels, for example.</p>
<figure><img src="../fig/primary_measure_length.png" alt="Screenshots of CellProfiler showing that nuclei diameters can be estimated using the measurement tool." class="figure mx-auto d-block"></figure><div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Note: in bigger experiments, this should be repeated with different
experimental conditions to make sure we are not biasing analyses.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-3-choose-a-thresholding-strategy-foreground-vs-background">Step 3: choose a thresholding strategy (foreground vs
background)<a class="anchor" aria-label="anchor" href="#step-3-choose-a-thresholding-strategy-foreground-vs-background"></a>
</h3>
<p>CellProfiler separates nuclei (foreground) from background using a
threshold. In the advanced settings of
<code>IdentifyPrimaryObjects</code>, you have the choice of two
threshold strategies:</p>
<ul>
<li>
<strong>Global thresholding</strong> (one threshold per image)</li>
<li>
<strong>Adaptive thresholding</strong> (threshold varies across the
image)</li>
</ul>
<p>Set the thresholding method appropriate for your images. If
illumination is uneven or background varies strongly, adaptive methods
often perform better.</p>
<div id="compare-thresholding-options" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="compare-thresholding-options" class="callout-inner">
<h3 class="callout-title">Compare thresholding options</h3>
<div class="callout-content">
<p>Run the module in Test Mode on 2–3 images and compare at least two
thresholding settings. Look out for things like</p>
<ul>
<li>Nuclei being merged or split (over- and undersegmentation)</li>
<li>Background being included in foreground</li>
</ul>
<p>Which setting best matches what you consider nuclei?</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Note that CellProfiler colors nuclei it will remove in subsequent
analyses in purple outlines. These nuclei are removed because they
either do not fit the set diameter range. Nuclei that will be kept are
outlined in green.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>In this dataset, as if often the case, it is difficult finding
perfect settings! Ideally, one spends a significant portion of time
optimizing the settings to make sure that results are biologically
representative of cells. In the figure below, you can see that changing
the segmentation strategy and method to <code>Adaptive</code> and
<code>Otsu</code>, respectively, may not make much of a difference. But
results of the segmentation with adaptive Otsu show that some pixels
that are parts of nuclei are discarded (top right). Note that the result
will also be affected by the settings we will change next. <img src="../fig/primary_global_vs_local.png" alt="Side by side comparison of segmentation results with different segmentation strategies" class="figure"></p>
</div>
</div>
</div>
</div>
<p>The images we use in this workshop are illuminated fairly evenly,
meaning that nuclei show up in roughly equal brightness no matter where
they are in the image. If you would like to see an example of uneven
illumination, for which adaptive segmentation is a lot more important,
on real images then watch this video: <a href="https://www.youtube.com/watch?v=ynrPqsOZVYE" class="external-link uri">https://www.youtube.com/watch?v=ynrPqsOZVYE</a></p>
</div>
<div class="section level3">
<h3 id="step-4-declump-touching-nuclei">Step 4: declump touching nuclei<a class="anchor" aria-label="anchor" href="#step-4-declump-touching-nuclei"></a>
</h3>
<p>Nuclei often touch or overlap, particular if many cells were seeded.
While a z-stack (3D slices) of images can help distinguish which nuclei
goes where, due to the increased imaging time needed and more complex
downstream analysis not all experiments involve z-stacks. Instead, we
can instruct CellProfiler to separate clumped nuclei using information
about nuclei shape and intensity.</p>
<div id="tune-declumping" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="tune-declumping" class="callout-inner">
<h3 class="callout-title">Tune declumping</h3>
<div class="callout-content">
<p>Find an image region with several touching nuclei. (In the sample
data, the image of cells treated with cytoD has more clumped nuclei.)
Adjust declumping parameters until most nuclei are separated
correctly.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Declumping </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>As before, it is not trivial to find ideal declumping settings. We
can get satisfactory results using <code>Shape</code> for both,
distinguishing clumped objects and drawing dividing lines here, but note
that this will differ for each dataset and should be carefully tested.
It might also be helpful to set
<code>Automatically calculate size of smoothing filter for declumping</code>
to <code>No</code> and playing with the
<code>Suppress local maxima that are closer than this minimum allowed distance</code>
parameter.</p>
<p>This figure shows the impact of not using declumping at all (left) vs
declumping using <code>Shape</code> (right). <img src="../fig/primary_declumping.png" alt="Enabling declumping can help discern nearby nuclei." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-5-optional-filter-cells">Step 5 (optional): filter cells<a class="anchor" aria-label="anchor" href="#step-5-optional-filter-cells"></a>
</h3>
<p>Depending on your dataset, you may need to exclude:</p>
<ul>
<li>tiny bright specks (dust/hot pixels),</li>
<li>very large blobs (out-of-focus regions),</li>
<li>edge artifacts.</li>
</ul>
<p>Within <strong>IdentifyPrimaryObjects</strong>, you can handle some
of this using:</p>
<ul>
<li>size constraints (min/max diameter),</li>
<li>smoothing of the image before thresholding,</li>
<li>discard objects touching the image border (if appropriate).</li>
</ul>
<div id="discuss-should-we-exclude-border-objects" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="discuss-should-we-exclude-border-objects" class="callout-inner">
<h3 class="callout-title">Discuss: should we exclude border
objects?</h3>
<div class="callout-content">
<p>With your neighbor, discuss whether nuclei touching the image border
should be kept or removed for your research question formulated in the
<a href="dataset.html">previous section</a>, e.g. “does cytochalasin D
induce a morphological change in MCF7 cells?”</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>In most cases we advise <strong>removing cells touching the image
border</strong>, because they will represent outliers when we move to
measuring cell characteristics. For example, they may appear as
disproportionately small cells because they were cut off. This does not
represent biological changes but technical parameters, which we are not
interested in during the analysis.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<hr class="half-width">
<p>Segmentation is rarely perfect, but it should be fit for purpose. A
good nucleus segmentation typically has:</p>
<ul>
<li>Most nuclei detected (i.e. nuclei do not get missed)</li>
<li>Few background objects detected</li>
<li>Reasonable splitting of touching nuclei</li>
<li>Consistent performance across conditions (e.g. DMSO vs
treatment)</li>
</ul>
<p>Now that we have <code>Nuclei</code> objects, we can detect whole
cells, an important step towards measuring features per cell! Therefore,
in the next episode we will use the nuclei as anchors to find cell
boundaries.</p>
<div class="section level3">
<h3 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a>
</h3>
<p>Did you get stuck with one of the steps? Download a working version
of the pipeline here:</p>
<p><a href="../data/pipeline_1.cppipe" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
pipeline</a></p>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you are using Firefox, you have to right click the button and
select <code>Save Link As...</code>.</p>
</div>
</div>
</div>
<p>After downloading the pipeline, you can compare it to yours for
troubleshooting. To do so, first open a new CellProfiler window
(<code>File &gt; New Project</code>). Then, import this pipeline in
CellProfiler by clicking on <code>File</code> &gt; <code>Import</code>
&gt; <code>Pipeline from File</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Nuclei are often the best primary objects because they have high
contrast and exist in nearly all cells.</li>
<li>The most important parameters in
<strong>IdentifyPrimaryObjects</strong> are object size, thresholding
method, and declumping.</li>
<li>Always test segmentation on multiple images and across experimental
conditions.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</section></section><section id="aio-detecting-cells"><p>Content from <a href="detecting-cells.html">Identifying secondary &amp; tertiary objects</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/detecting-cells.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we detect whole cells once we have identified nuclei?</li>
<li>What is the differences between detecting primary, secondary, and
tertiary objects?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use <strong>IdentifySecondaryObjects</strong> to segment whole cells
from an actin image.</li>
<li>Understand how secondary objects depend on primary objects.</li>
<li>Learn how propagation-based segmentation expands from nuclei to cell
edges.</li>
<li>Create a cell object set suitable for per-cell measurements.</li>
<li>Use <strong>IdentifyTertiaryObjects</strong> to create cytoplasm
masks.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="from-nuclei-to-whole-cells">From nuclei to whole cells<a class="anchor" aria-label="anchor" href="#from-nuclei-to-whole-cells"></a>
</h2>
<hr class="half-width">
<p>In the previous section, we identified nuclei as <strong>primary
objects</strong>. This gives us “seed” objects: one nucleus per
cell.</p>
<p>However, many biologically interesting measurements (e.g. cell area,
shape and cytoplasmic fluorescence) require us to segment the
<strong>whole cell</strong>. This is often more challenging than nuclei
segmentation because:</p>
<ul>
<li>cytoplasm and boundaries can be <strong>fainter</strong> than
nuclei,</li>
<li>neighboring cells may <strong>touch</strong> or overlap,</li>
<li>staining can be <strong>uneven</strong> across the cell body.</li>
</ul>
<p>To tackle this, CellProfiler provides
<code>IdentifySecondaryObjects</code>, which grows secondary objects
outward from nuclei using information from another image (here an actin
channel). This approach helps prevent ambiguous assignments of boundary
pixels by ensuring each cell is linked to exactly one starting
nucleus.</p>
</section><section><h2 class="section-heading" id="the-identifysecondaryobjects-module">The IdentifySecondaryObjects module<a class="anchor" aria-label="anchor" href="#the-identifysecondaryobjects-module"></a>
</h2>
<hr class="half-width">
<p>Add a new module via <strong>+ Add</strong> → <strong>Object
Processing</strong> → <strong>IdentifySecondaryObjects</strong>.</p>
<p>You should now see a module where you need to specify:</p>
<ol style="list-style-type: decimal">
<li>which primary objects act as “seeds” (nuclei),</li>
<li>which image contains cell boundary information (actin),</li>
<li>how to determine where each cell ends (thresholding + method),</li>
<li>how to handle cells touching the image border.</li>
</ol>
<div class="section level3">
<h3 id="step-1-choose-primary-input-objects">Step 1: choose primary input objects<a class="anchor" aria-label="anchor" href="#step-1-choose-primary-input-objects"></a>
</h3>
<p>Set <code>Select the input objects</code> (or similarly named
setting) to <code>Nuclei</code> or the name you set in the previous
lesson. This tells CellProfiler that each cell object should be grown
outward from one nucleus.</p>
</div>
<div class="section level3">
<h3 id="step-2-choose-the-correct-input-image-actin">Step 2: choose the correct input image (actin)<a class="anchor" aria-label="anchor" href="#step-2-choose-the-correct-input-image-actin"></a>
</h3>
<p>Set <code>Select the input image</code> to your actin (or
cytoplasmic) channel, e.g. <code>Actin</code> (or whatever name you
assigned in <code>NamesAndTypes</code>).</p>
<p>The channel should contain relatively strong signal across the cell
body and/or along the cell boundary.</p>
<div id="checking-the-actin-image" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="checking-the-actin-image" class="callout-inner">
<h3 class="callout-title">Checking the actin image</h3>
<div class="callout-content">
<p>Using Test Mode, inspect a few images:</p>
<ul>
<li>Can you see whole cell bodies?</li>
<li>Are neighboring cells separable?</li>
<li>Is the background reasonably dark?</li>
</ul>
<p>If not, what issues do you observe?</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you find the contrast too dim to see the channel well, you can
increase the contrast. You can do so either by right clicking &gt;
<code>Adjust Contrast</code>, or by selecting
<code>Subplots &gt; (Object name) outlines &gt; Adjust Contrast</code>.
Then, select <code>Log normalized</code> and a
<code>normalization factor</code> that you deem suitable, the click
<code>Apply to all</code>. <img src="../fig/secondary_contrast.png" alt="Screenshots showing that contrast be adjusted using Subplots &gt; (Object name) outlines &gt; Adjust Contrast and selecting Log normalized and a normalization factor in the range of 2-5, the clicking Apply to all." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Compared to nuclei, cell boundaries are often less easily
distinguished. We can see that the actin channel does increase at cell
junctions, which should help in segmenting the cells in later steps. But
it is important to keep in mind that any segmentation will not be
perfect here: after all, where would you draw the boundaries by hand?
<img src="../fig/secondary_actin_dna.png" alt="Picture of cells, with DNA stain shown in blue and actin stain shown in gray. While nuclei are fairly well separated, cell boundaries are touching in many places and are not easily distinguished." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-3-choose-a-method-to-identify-secondary-objects">Step 3: choose a method to identify secondary objects<a class="anchor" aria-label="anchor" href="#step-3-choose-a-method-to-identify-secondary-objects"></a>
</h3>
<p>Now we will use <code>IdentifySecondaryObjects</code> to segment
cells. Many of the options are the same as in
<code>IdentifyPrimaryObjects</code>, but the most important difference
is the presence of
<code>Select the method to identify the secondary objects</code> option.
We encourage you to read their descriptions in CellProfiler by clicking
the <code>?</code> symbol, but most often it is set to
<code>Propagation</code>. To see why, let’s see what happens when we try
segmenting cells with either method!</p>
<div id="optional-challenge-explore-methods" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="optional-challenge-explore-methods" class="callout-inner">
<h3 class="callout-title">Optional challenge: explore methods</h3>
<div class="callout-content">
<p>Try two different methods (e.g. propagation vs watershed gradient).
How do the resulting cell boundaries differ?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Comparing methods </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>As with the segmentation of nuclei, getting cell segmentation right
can be tricky. Often, starting with <code>propagation</code> as method
is a good starting point, because watershed can expand into neighboring
cells (see below). But you can certainly find areas of the image where
the reverse is true. This means that, once again, choices should be made
carefully. <img src="../fig/secondary_watershed_propagation.png" alt="Comparing two methods of identifying cell boundaries: watershed and propagation. Using watershed, some cell boundaries spill over into adjacent cells, leading to incorrect cell masks." class="figure"></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-4-choose-a-threshold-strategy-and-threshold-method">Step 4: choose a threshold strategy and threshold method<a class="anchor" aria-label="anchor" href="#step-4-choose-a-threshold-strategy-and-threshold-method"></a>
</h3>
<p>Much like when segmenting nuclei, the
<code>IdentifySecondaryObjects</code> module allows us to fine-tune our
segmentation by changing the thresholding strategy and method. As
before, the best choice depends on illumination and staining
consistency. While <strong>Minimum Cross-Entropy</strong> (right) is the
default thresholding method, <strong>Otsu</strong> (left) can often also
yield good masks and makes a bit fewer assumptions about your image. For
this dataset they perform very similarly, except that Minimum
Cross-Entropy does slightly better at detecting protrusions such as in
the below image.</p>
<figure><img src="../fig/secondary_otsu_me.png" alt="Side-by-side of Otsu and minimum cross-entropy thresholding results." class="figure mx-auto d-block"></figure><div id="challenge-biological-pitfalls" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-biological-pitfalls" class="callout-inner">
<h3 class="callout-title">Challenge: biological pitfalls</h3>
<div class="callout-content">
<p>Think about the assumptions CellProfiler is making in its
identification of secondary objects. Can you think of biological samples
where these assumptions may not be met? Discuss with your neighbor.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>CellProfiler identifies cells by expanding outwards from a nucleus.
This assumes that <strong>each cell only has exactly one
nucleus</strong> in the same plane. When imaging hepatocytes, for
example, this can prove problematic: they often contain more than one
nucleus. Equally, if we were imaging cells in suspension, we would have
to make sure than we <strong>capture the nucleus accurately in
3D</strong> and expand the cell in 3D space too. And lastly, red blood
cells do not even have a nucleus, so this method would not work for them
either!</p>
<p>Other pitfalls include <strong>mitotic/meiotic cells</strong>: from
when on do we term a splitting cell as two cells? When the two nuclei
have budded off, or when the membrane is fully split? CellProfiler
cannot answer these questions for us, instead, we must consider these
biological complexities when designing our analysis pipeline to not
yield nonsensical data down the line.</p>
</div>
</div>
</div>
</div>
<p>Once you are happy with the result, make sure to check the following
options:</p>
<ol style="list-style-type: decimal">
<li>Fill holes in identified objects: Yes</li>
<li>Discard secondary objects touching the border of the image: Yes</li>
<li>Discard the associated primary objects: Yes</li>
</ol>
<p>And finally, name the new primary objects thus filtered,
e.g. <code>Nuclei_Filtered</code>.</p>
</div>
</section><section><h2 class="section-heading" id="identifying-cytoplasm">Identifying cytoplasm<a class="anchor" aria-label="anchor" href="#identifying-cytoplasm"></a>
</h2>
<hr class="half-width">
<p>You have now created whole-cell objects from nuclei seeds and an
actin image. Well done! 🎉</p>
<p>With nuclei and cells in hand, we can create one last object: the
cytoplasm. Fortunately, this one is easy:</p>
<blockquote>
<p>Cytoplasm = Cell - Nucleus</p>
</blockquote>
<p>To do this, add the <code>IdentifyTertiaryObjects</code> module and
select what you think are the correct options.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Suggested settings </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<ul>
<li>Larger objects: cells identified with
<code>IdentifySecondaryObjects</code>
</li>
<li>Smaller objects: nuclei filtered in
<code>IdentifySecondaryObjects</code>
</li>
<li>Name: e.g. <code>Cytoplasm</code>
</li>
<li>Shrink smaller object prior to subtraction: <code>Yes</code>
(default)</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<hr class="half-width">
<p>Finally, we have created all masks we need and can move on to measure
things!</p>
<div class="section level3">
<h3 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a>
</h3>
<p>Did you get stuck with one of the steps? Download a working version
of the pipeline here:</p>
<p><a href="../data/pipeline_2.cppipe" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
pipeline</a></p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you are using Firefox, you have to right click the button and
select <code>Save Link As...</code>.</p>
</div>
</div>
</div>
<p>After downloading the pipeline, you can compare it to yours for
troubleshooting. To do so, first open a new CellProfiler window. Then,
import this pipeline in CellProfiler by clicking on <code>File</code>
&gt; <code>Import</code> &gt; <code>Pipeline from File</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Secondary objects (cells) are typically grown from primary objects
(nuclei) using a cytoplasmic/cell-boundary stain (here: actin).</li>
<li>Filtering border-touching nuclei helps avoid partial cells and
misleading measurements.</li>
<li>The most important settings in
<strong>IdentifySecondaryObjects</strong> are the identification method
and thresholding choices, which strongly affect whether cells merge or
fragment.</li>
<li>Tertiary objects (cytoplasm) are a subtraction of nuclei from the
cell mask.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</section></section><section id="aio-measure-features"><p>Content from <a href="measure-features.html">Measuring object intensity and shape</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/measure-features.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Once we have segmentation masks, what can CellProfiler measure from
them?</li>
<li>What is the difference between intensity measurements and shape
measurements?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use <strong>MeasureObjectIntensity</strong> to quantify fluorescence
per nucleus, cell, and cytoplasm.</li>
<li>Use <strong>MeasureObjectSizeShape</strong> to quantify area/shape
descriptors for each object.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="measuring-turning-segmentations-into-numbers">Measuring: turning segmentations into numbers<a class="anchor" aria-label="anchor" href="#measuring-turning-segmentations-into-numbers"></a>
</h2>
<hr class="half-width">
<p>So far, we have been creating masks: pixels belonging to nuclei,
cells, and cytoplasm. Masks are useful on their own for quality control,
but the real power of CellProfiler is that it can turn masks into
<strong>quantitative measurements</strong>.</p>
<p>In this episode, we will measure two broad classes of features:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Intensity features</strong>: “how bright is this object in a
given channel?”
<ul>
<li>Example questions:
<ul>
<li>Is actin intensity higher in treated cells?</li>
<li>Do nuclei become brighter/dimmer in the DNA channel?</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>Size and shape features</strong>: “what is the geometry of
this object?”
<ul>
<li>Example questions:
<ul>
<li>Do cells spread out or shrink?</li>
<li>Do nuclei become larger or more elongated?</li>
</ul>
</li>
</ul>
</li>
</ol></section><section><h2 class="section-heading" id="measureobjectintensity-measuring-fluorescence-per-object">MeasureObjectIntensity: measuring fluorescence per object<a class="anchor" aria-label="anchor" href="#measureobjectintensity-measuring-fluorescence-per-object"></a>
</h2>
<hr class="half-width">
<p>Add the <code>MeasureObjectIntensity</code> module to your
pipeline.</p>
<p>This module measures per-object intensity statistics for one or more
images. For example, it can quantify the DNA stain in the nucleus, or
the actin stain intensity in the cytoplasm.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>What channel should be measured in what part of the cell? For
example, should we quantify DNA signal only in the nucleus, or
everywhere (nucleus, cytoplasm, whole cell)? Discuss with your
neighbor.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The simplest setup is to measure all channels in all parts of the
cells and decide which measurements to interpret down the line. Perhaps
surprisingly, this is the approach frequently chosen in high-throughput
experiments: measure everything, ask questions later. And indeed, one
can envision scenarios where measuring e.g. DNA in the cytoplasm may
prove useful if <a href="https://doi.org/10.1073/pnas.1404171111" class="external-link">DNA
leaks through the nuclear envelope due to environmental stress</a>.</p>
<p>That said, if you have a narrow research question and an idea of
where to look for changes in cell morphology, then only measuring the
correct combination of channel and cell components will be the right
approach.</p>
</div>
</div>
</div>
</div>
<p>To set this up in CellProfiler, for
<code>Select the objects to measure</code> select:</p>
<ul>
<li><code>Nuclei_Filtered</code></li>
<li><code>Cells</code></li>
<li><code>Cytoplasm</code></li>
</ul>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Note: these names may differ, depending on what you called them in
previous modules. We will not use the nuclei created in
<code>IdentifyPrimaryObjects</code>, because we filtered them in
<code>IdentifySecondaryObjects</code> to only contain nuclei of cells
that are not touching the image boundary.</p>
</div>
</div>
</div>
<p>Then, select all channels in <code>Select images to measure</code>,
unless you would like to only measure some of the channels. Finally, run
the module in test mode and look at the output.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Let’s see whether the DNA intensity is higher in the cytoplasm or the
nucleus. Using the table that the module outputs in test mode, look for
a row with <code>DNA - Cytoplasm - MeanIntensity</code> and read off the
value in the <code>Mean</code> column. Then repeat this for
<code>DNA - Nuclei_Filtered - MeanIntensity</code>. What do you
observe?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Depending on your segmentation settings and which image you are using
to test, the mean DNA intensity is about 3-4x higher in nuclei than in
the cytoplasm, as you would expect.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="measureobjectsizeshape-measuring-geometry">MeasureObjectSizeShape: measuring geometry<a class="anchor" aria-label="anchor" href="#measureobjectsizeshape-measuring-geometry"></a>
</h2>
<hr class="half-width">
<p>Beyond fluorescence intensities, it is common to measure shape
descriptors of cells. Example measurements include:</p>
<ul>
<li>area</li>
<li>perimeter</li>
<li>eccentricity / elongation</li>
<li>compactness</li>
</ul>
<p>Once again, we add the module (<code>MeasureObjectSizeShape</code>)
and select our objects to measure in as before. For this workshop,
disable Zernike and advanced features, as they slow down CellProfiler,
which can be annoying while building the pipeline.</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>CellProfiler measures many things - including some with names that
most will never have heard of. The helps a lot with deciphering the
measurement names. For example, for <code>eccentricity</code> it
contains this helpful image: <img src="https://cellprofiler-manual.s3.amazonaws.com/CellProfiler-4.2.8/_images/MeasureObjectSizeShape_Eccentricity.png" alt="Circles that are increasingly stretched into long ovals. Beneath the circles are values for eccentricity, which go from 0 (perfect circle) toward 1 (extremely stretched oval)." class="figure">
Which shows that eccentricity will be higher for elongated cells.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-3-sanity-check-measurements">Step 3: Sanity check measurements<a class="anchor" aria-label="anchor" href="#step-3-sanity-check-measurements"></a>
</h3>
<p>When building a workflow, it is worthwhile checking outputs at each
step. For measurements this can be a bit harder than with segmentation,
but one of the things we can check is the cytoplasm/nucleus area ratio.
We have now seen many example images of these MCF7 cells and could
venture a guess that the cytoplasm occupies more space than the nuclei
(in 2D).</p>
<div id="calculate-the-cytoplasmnucleus-ratio" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="calculate-the-cytoplasmnucleus-ratio" class="callout-inner">
<h3 class="callout-title">Calculate the cytoplasm/nucleus ratio</h3>
<div class="callout-content">
<p>Run the module in test mode and look for the <code>Area</code>
feature for <code>Cytoplasm</code> and <code>Nuclei_Filtered</code> (or
equivalent names in your pipeline). This feature describes the average
number of pixels occupied by the cytoplasm/nucleus. Now calculate the
ratio of the cytoplasm to nucleus area.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The cytoplasm occupies about 3-4x more space than the nucleus. Again,
depending on your segmentation settings, your result may differ. This is
in line with our observations from images of the cells.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="exporting-measurements">Exporting measurements<a class="anchor" aria-label="anchor" href="#exporting-measurements"></a>
</h2>
<hr class="half-width">
<p>So far we have created segmentation masks and computed measurements
(intensity and size/shape). To use these measurements outside
CellProfiler (e.g. in R, Python, or Excel), we need to export them to
files. One standard way to do this is the
<code>ExportToSpreadsheet</code> module.</p>
<p>Add the <code>ExportToSpreadsheet</code> module. For this workshop,
the default settings are fine. The most important thing is that:</p>
<ul>
<li>the module exports <strong>object-level measurements</strong> (for
<code>Nuclei_Filtered</code>, <code>Cells</code>, and
<code>Cytoplasm</code>), and</li>
<li>you need to know where the files are written to.</li>
</ul>
<div id="challenge-export-your-measurements" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-export-your-measurements" class="callout-inner">
<h3 class="callout-title">Challenge: export your measurements</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Add <strong>ExportToSpreadsheet</strong> at the end of your
pipeline.</li>
<li>Run the pipeline (not in test mode, but by clicking
<code>Analyze images</code>)</li>
<li>Find the exported files on disk.</li>
</ol>
<p>Questions: - What file format(s) were produced
(e.g. <code>.csv</code>)? - Do you get separate files for
<code>Nuclei_Filtered</code>, <code>Cells</code>, and
<code>Cytoplasm</code>? - Open up one of the files. Can you identify at
least one column coming from intensity measurements and one coming from
shape measurements?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>With default settings, CellProfiler typically exports one spreadsheet
per object type (e.g. one for nuclei, one for cells, one for cytoplasm),
plus one for image-level measurements if any were computed.</p>
<p>Open one of the exported spreadsheets and look for column names such
as:</p>
<ul>
<li>
<code>Intensity_MeanIntensity_*</code> or
<code>Intensity_IntegratedIntensity_*</code> (from
<code>MeasureObjectIntensity</code>)</li>
<li>
<code>AreaShape_Area</code> / <code>AreaShape_Perimeter</code> /
<code>AreaShape_Eccentricity</code> (from
<code>MeasureObjectSizeShape</code>)</li>
</ul>
<p>If you cannot find the files, check the
<code>Output file location</code> setting in
<code>ExportToSpreadsheet</code> and re-run the pipeline.</p>
</div>
</div>
</div>
</div>
<div id="tip-run-on-a-subset-first" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="tip-run-on-a-subset-first" class="callout-inner">
<h3 class="callout-title">Tip: run on a subset first</h3>
<div class="callout-content">
<p>When developing a pipeline, it’s often faster to run on a small
subset of images first to confirm that exports look correct. Once you’re
satisfied, run the pipeline on the full dataset. In this exercise, you
have only been provided with a few images so this does not apply, but it
will make a big difference when dealing with hundreds of images.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<hr class="half-width">
<p>We have now added measurement modules to compute:</p>
<ul>
<li>per-object fluorescence intensities (per nucleus, cell,
cytoplasm)</li>
<li>per-object morphology features (size and shape)</li>
</ul>
<p>These features are the raw material for downstream analyses like
comparing treated vs control populations, building morphological
profiles, or training classifiers.</p>
<div class="section level3">
<h3 id="help">Help<a class="anchor" aria-label="anchor" href="#help"></a>
</h3>
<p>Did you get stuck with one of the steps? Download a working version
of the pipeline here:</p>
<p><a href="../data/pipeline.cppipe" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
pipeline</a></p>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you are using Firefox, you have to right click the button and
select <code>Save Link As...</code>.</p>
</div>
</div>
</div>
<p>After downloading the pipeline, you can compare it to yours for
troubleshooting. To do so, first open a new CellProfiler window. Then,
import this pipeline in CellProfiler by clicking on <code>File</code>
&gt; <code>Import</code> &gt; <code>Pipeline from File</code>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>
<strong>MeasureObjectIntensity</strong> quantifies fluorescence per
object; choose objects and channels deliberately.</li>
<li>
<strong>MeasureObjectSizeShape</strong> quantifies morphology;
disable Zernike/advanced features to iterate faster.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</section></section><section id="aio-reproducibility"><p>Content from <a href="reproducibility.html">Reproducibility in CellProfiler</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/reproducibility.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the difference between saving a CellProfiler project and
exporting a pipeline?</li>
<li>Which approach is more portable across computers and
collaborators?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Practice sharing both formats with a neighbor and observe what
breaks.</li>
<li>Verify reproducibility by comparing exported measurements.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A CellProfiler analysis is only useful if someone else (or future
you) can reproduce it. In practice, “someone else” might be the person
sitting next to you today, using a different computer with a different
folder structure. But more generally, reproducibility is important at
many stages: when you come back to your analysis two years later, when
the next student wants to pick up the project, or when you publish your
results. Reviewers may well demand access to the pipeline to see which
steps were done to analyse images. So how do we share our workflow?</p>
<p>CellProfiler gives you two common ways to save your work:</p>
<p><strong>Save Project</strong> captures your whole working session,
including the image file list. This is convenient when you want to pause
and continue later on the same computer.</p>
<p><strong>Export Pipeline</strong> captures your analysis recipe
(modules + settings), but not the image file list. Which one is better
for sharing your workflow? Let’s find out!</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Save your workflow in CellProfiler in both ways:</p>
<ol style="list-style-type: decimal">
<li><strong>File → Save Project</strong></li>
<li><strong>File → Export → Pipeline</strong></li>
</ol>
<p>naming them with your name. Note the different file endings,
<code>.cpproj</code> for the former and <code>.cppipe</code> for the
latter.</p>
<p>Then share the file with your neighbor by following the instructions
below.</p>
</div>
</div>
</div>
<p>You have a few options to quickly share your files. If you have a USB
stick with you, that may be the fastest option. But otherwise follow the
instructions under <code>Online file share</code>.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  USB stick
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  Online file share
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" aria-labelledby="nav-tab-1-1" role="tabpanel">
<p>If you have a USB stick, just copy the files onto it, pass it to your
neighbor and have them copy it onto their computer for testing.
Easy!</p>
</div>
<div id="nav-tabpanel-1-2" class="tab-pane" aria-labelledby="nav-tab-1-2" role="tabpanel">
<p>If you do not have a USB stick with you, we can use an online file
sharing solution. You can use email/OneDrive/Dropbox/Google Drive if you
like, or follow the instructions below if you do not want to create an
account on a service.</p>
<ol style="list-style-type: decimal">
<li>Both you and your neighbor should open <a href="https://toffeeshare.com" class="external-link uri">https://toffeeshare.com</a>
</li>
<li>You share one of the two files by clicking on the <code>+</code>
<img src="../fig/reproducibility_toffeeshare.png" alt="Toffeeshare website" class="figure">. Note that toffeeshare only allows sharing
one file at a time. You can zip the two files to an archive to only
share one file if you prefer, in which case skip step 7.</li>
<li>Make sure to set the <code>Local sharing code</code> option <img src="../fig/reproducibility_toffeeshare_options.png" alt="Toffeeshare website sharing options" class="figure">
</li>
<li>Your neighbor now clicks on <code>Nearby devices</code> in the top
right</li>
<li>Then, they enter the share code displayed on your device.</li>
<li>The download should start within ~10 seconds, make sure you both
keep the window open in the meantime.</li>
<li>Repeat 1-6 with the other file.</li>
<li>Repeat 1-7 with your neighbor now sharing their files with you.</li>
</ol>
</div>
</div>
</div>
<p>You should now have shared your workflows with each other, each
having two files of the other:</p>
<ol style="list-style-type: decimal">
<li>The pipeline file (<code>.cppipe</code>)</li>
<li>The project file (<code>.cpproj</code>)</li>
</ol>
<div id="try-to-reproduce-your-neighbours-results" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="try-to-reproduce-your-neighbours-results" class="callout-inner">
<h3 class="callout-title">Try to reproduce your neighbour’s results</h3>
<div class="callout-content">
<p>Start with loading the project file into CellProfiler with
<strong>File → Load Project</strong>. You may get a warning about
version mismatches, this can usually be ignored but using the latest
available version is advised.</p>
<p>Try going through the workflow. Does everything work as you would
expect?</p>
<p>You can verify that you are getting the same results by looking at
the output of <code>MeasureObjectIntensity</code> in test mode and
comparing with each other.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The workflow should be reproducible, but you may encounter an issue:
the images loaded in with the <code>Images</code> module are not in the
same location on your computer. You will have to select and delete them
(right click &gt; <code>Remove From File List</code>). Then, add the
images into CellProfiler again. Now run through the workflow.</p>
</div>
</div>
</div>
</div>
<p>As you may have noticed, most of the workflow was reproducible, but
we had to switch out the images first. The other way of sharing a
workflow avoids this.</p>
<p>In a new CellProfiler window (File &gt; New Project), load in the
<code>.cppipe</code> file by using
<code>File &gt; Import &gt; Pipeline From File</code>. Load in the
images and go through the workflow again. You should notice that the
results remain unchanged.</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Recall from <a href="introduction#metadata">episode 2</a> that we
extract metadata from the file but not folder names in this exercise.
This can differ between projects - for example, you may have a different
folder for each day of imaging. In this case, you will need to reproduce
the folder structure on the new PC before you will be able to run the
pipeline.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="practical-takeaways">Practical takeaways<a class="anchor" aria-label="anchor" href="#practical-takeaways"></a>
</h2>
<hr class="half-width">
<p>When you want to continue your own work, saving the project is
convenient.</p>
<p>When you want to share a reproducible analysis workflow, exporting
the pipeline is usually the better default. If you share a pipeline, it
is a good idea to also share some example images for testing. And of
course for full reproducibility, you need to <a href="https://doi.org/10.1111/jmi.13317" class="external-link">share all images</a>.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>
<strong>Save Project</strong> is great for restoring a full session,
but often stores image paths that are not portable.</li>
<li>
<strong>Export/Import Pipeline</strong> is a more reproducible way
to share an analysis workflow.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</section></section><section id="aio-bonus"><p>Content from <a href="bonus.html">Bonus: visualising features</a></p>
<hr>
<p>Last updated on 2026-02-02 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/bonus.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you read CellProfiler’s exports?</li>
<li>What information can be gleamed from them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a simple figure in Excel</li>
<li>Using Morpheus to investigate how cytoD affects cell morphology</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Finished with the previous steps already? Well done! In this episode
we will dive into the data that CellProfiler outputs and start to get a
feel for the problems we may face in analyzing it.</p>
<p>To start with, find the folder with the <code>.csv</code> files
created in the previous episode. There should be 5-6 files in the
folder, prefixed by whatever we set in the settings of the export
module.</p>
<ul>
<li>
<code>Experiment.csv</code> contains basic information about the
pipeline.</li>
<li>
<code>Image.csv</code> at its most basic just contains image
indeces, although one can also export per-image features.</li>
<li>The remaining files are per-object, e.g. <code>Cells.csv</code>.
These represent features per single-cell and are perhaps the most
interesting to analyse.</li>
</ul>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If you do not have an output file handy, you can download this one
for the tutorial:</p>
<p><a href="../data/MyExpt_Cells.csv" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
csv</a></p>
</div>
</div>
</div>
<p>Open one of the files in Excel. Now we wish to check whether cytoD
had any impact on cell morphology. Recall that cytoD is an actin
inhibitor, so we may reasonably expect that cells will be smaller after
treatment with cytoD.</p>
<div class="section level3">
<h3 id="basic-test-of-cell-size-in-excel">Basic test of cell size in Excel<a class="anchor" aria-label="anchor" href="#basic-test-of-cell-size-in-excel"></a>
</h3>
<p>To test this, click on column “H” (Metadata_Treatment) to select it.
Then, while keeping the <code>Ctrl</code> key (Command ⌘ on Mac) pressed
, click on column “J” (AreaShape_Area). In the top, go to
<code>Insert</code> &gt; <code>Recommended charts</code> and select the
top one (<code>Clustered Column</code>), then press <code>Okay</code>.
By default, this gives us a sum of pixels covered by cells in each
treatment. To change it to the more meaningful average (i.e. size of
cell on average per treatment), click on the graph, then in the bottom
right under <code>Values</code> click on the
<code>Sum of AreaShape_Area</code>, then
<code>Value Field Settings</code>. In the pop up window, select
<code>Average</code> and press <code>Okay</code>. What does the chart
show?</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Show details </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>You should get a table and bar chart similar to this: <img src="../fig/bonus_excel_bar.png" alt="Bar graph showing that cells treated with cytoD are about ~30 percent points smaller than cells treated with DMSO only, on average." class="figure"></p>
<p>If we do the math, this shows that cells treated with cytoD are about
~30 percent points smaller than cells treated with DMSO only, on
average.</p>
</div>
</div>
</div>
</div>
<p>This is a great start, we can see that our treatment is indeed having
a quantifiable effect! But how can we check this for all features,
ideally in an automated way? And how can we skip the averaging that
Excel is doing here entirely, and cluster single-cells?</p>
</div>
<div class="section level3">
<h3 id="advanced-analysis">Advanced analysis<a class="anchor" aria-label="anchor" href="#advanced-analysis"></a>
</h3>
<p>Depending on your expertise with programming, you have a few options.
If you</p>
<ul>
<li>would like to just see a quick result, skip to the next section</li>
<li>have experience in Python programming, use <a href="https://pycytominer.readthedocs.io/en/stable/" class="external-link">pycytominer</a>, a
Python package that can be used to the analyse morphological
features.</li>
<li>have no experience in Python yet but would like to learn, attend our
future <a href="https://dbi-infra.eu/dbi-infra-events/python4bia" class="external-link">Python
workshop</a>!</li>
<li>would like help to analyse your results in depth, <a href="https://www.dbi-infra.eu/iacf-about#contact" class="external-link">contact us</a>!</li>
</ul>
<div class="section level4">
<h4 id="analysis-with-morpheus">Analysis with Morpheus<a class="anchor" aria-label="anchor" href="#analysis-with-morpheus"></a>
</h4>
<p>One useful tool to visualize CellProfiler outputs is Morpheus: <a href="https://software.broadinstitute.org/morpheus/" class="external-link uri">https://software.broadinstitute.org/morpheus/</a></p>
<p>Morpheus is a matrix visualization tool that can quickly cluster rows
and columns.</p>
<p>To see it in action, first download the sample input below, which we
created from a CellProfiler output. Note that CellProfiler output cannot
be loaded into Morpheus straight, but requires some preprocessing, which
in this case we did for you using Python.</p>
<p><a href="../data/CellProfiler_singleCell.json" download class="btn btn-primary" style="display:inline-block;padding:8px 12px;background:#007bff;color:#fff;border-radius:4px;text-decoration:none;">Download
Morpheus input</a></p>
<p>Then open <a href="https://software.broadinstitute.org/morpheus/" class="external-link uri">https://software.broadinstitute.org/morpheus/</a> and drop
the file into Morpheus. You should now have a view like this:</p>
<p><img src="../fig/bonus_morpheus.png" alt="Screenshot of morpheus, showing a heatmap with cells in columns and features in rows." class="figure">
Each column represents measurements from a single cell. Each row
represents a measurement. The boxes are color coded by the feature value
for this cell (after some normalization). Cells (columns) are clustered
based on similarity to each other.</p>
<p>Spend some time getting acquainted with the interface. Can you
identify which cells belonged to which treatment? Do the cells cluster
separately? Which features seem to have changed after treatment with
cytoD?</p>
<p>Unfortunately, preparing an input file for Morpheus is not very
straightforward, because it involves some normalization and, in bigger
experiments, batch correction steps. It would also not be suitable for
experiments with more than a few hundred cells, because you will quickly
lose sight of the large data.</p>
<p>Therefore, we recommend contacting DBI-INFRA if you would like to
learn more:</p>
<p><a href="https://www.dbi-infra.eu/iacf-about#contact" class="external-link btn btn-primary" style="display:inline-block;padding:8px 12px;background:#c60c30;color:#fff;border-radius:4px;text-decoration:none;">Contact
DBI-INFRA</a></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>CellProfiler writes one <code>.csv</code> per object type
(i.e. Nuclei, Cells, Cytoplasm).</li>
<li>Exported files contain many columns with metadata.</li>
<li>Morpheus can be useful to interrogate morphological changes.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</div>
</div></section><section id="aio-cellprofiler-analyst"><p>Content from <a href="cellprofiler-analyst.html">Advanced: classifying cells in CellProfiler Analyst</a></p>
<hr>
<p>Last updated on 2026-02-03 |

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/episodes/cellprofiler-analyst.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you classify cells with CellProfiler Analyst?</li>
<li>What files do you need to move from CellProfiler to CellProfiler
Analyst?</li>
<li>How can you tell whether your classifier is performing well?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Demonstrate how to export a database and properties file from
CellProfiler.</li>
<li>Walk through the CellProfiler Analyst interface (image viewing +
classifier).</li>
<li>Gain experience training and evaluating a simple phenotype
classifier.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="cellprofiler-analyst-an-introduction">CellProfiler Analyst: an introduction<a class="anchor" aria-label="anchor" href="#cellprofiler-analyst-an-introduction"></a>
</h2>
<hr class="half-width">
<p><strong>CellProfiler Analyst (CPA)</strong> is a companion tool to
CellProfiler. While CellProfiler is used to <em>segment</em> objects and
<em>measure</em> them, CPA is often used to <strong>explore</strong>
those measurements and to <strong>classify cells into
phenotypes</strong> (e.g. “healthy” vs “unhealthy”) using machine
learning.</p>
<p>Why would we want to do this?</p>
<ul>
<li>You may want to <strong>scale up detection of a phenotype</strong>
that is obvious to a human but hard to summarize with a single
metric.</li>
<li>You may want to identify <strong>rare events</strong>, like mitotic
cells.</li>
<li>You may want to find <strong>abnormal cell states</strong>,
e.g. stressed or apoptotic cells.</li>
</ul>
<div id="cpa-has-rough-edges" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="cpa-has-rough-edges" class="callout-inner">
<h3 class="callout-title">CPA has rough edges</h3>
<div class="callout-content">
<p>CPA is useful, but less actively developed than CellProfiler, and it
can be “picky” about inputs. Today we will likely see at least one rough
edge: CPA expects a clean 1-to-1 relationship between objects in the
database (e.g. one cell ↔︎ one nucleus), but not all pipelines export
perfectly into a CPA-friendly format without additional processing.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<hr class="half-width">
<p>Before proceeding, make sure you:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Install CellProfiler Analyst</strong><br>
Download and install CPA from: <a href="https://cellprofileranalyst.org/releases" class="external-link uri">https://cellprofileranalyst.org/releases</a></p></li>
<li>
<p><strong>Download the additional sample data</strong></p>
<ul>
<li>SQLite database: <code>data/analyst/DefaultDB.db</code>
</li>
<li>Properties file:
<code>data/analyst/DefaultDB_MyExpt.properties</code>
</li>
</ul>
</li>
</ol></section><section><h2 class="section-heading" id="first-open-of-cellprofiler-analyst">First open of CellProfiler Analyst<a class="anchor" aria-label="anchor" href="#first-open-of-cellprofiler-analyst"></a>
</h2>
<hr class="half-width">
<p>CPA always needs a <strong>properties file</strong> to know: - where
your database lives, - what tables/columns hold object measurements, -
where to find images.</p>
<div id="challenge-open-cpa" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-open-cpa" class="callout-inner">
<h3 class="callout-title">Challenge: open CPA</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Launch CellProfiler Analyst.</li>
<li>Don’t select anything yet—just observe what CPA asks you for.</li>
</ol>
<p>What file does it require before you can do anything useful?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>CPA requires a <strong>properties file</strong>
(<code>.properties</code>) that describes the database and how to
interpret it. You can generate this from CellProfiler
(<code>ExportToDatabase</code>), or use the pre-made one for this
workshop.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="creating-cpa-inputs-from-cellprofiler-exporttodatabase">Creating CPA inputs from CellProfiler (ExportToDatabase)<a class="anchor" aria-label="anchor" href="#creating-cpa-inputs-from-cellprofiler-exporttodatabase"></a>
</h2>
<hr class="half-width">
<p>CPA expects measurements in a database (often SQLite). CellProfiler
can create this using the <strong>ExportToDatabase</strong> module.</p>
<p>This export is <strong>different</strong> from
<code>ExportToSpreadsheet</code>:</p>
<ul>
<li>
<strong>ExportToSpreadsheet</strong> creates human-readable tables
(CSV) that are great for R/Python/Excel.</li>
<li>
<strong>ExportToDatabase</strong> creates a database plus an
optional CPA <strong>properties file</strong> that CPA can read.</li>
</ul>
<div class="section level3">
<h3 id="add-and-configure-exporttodatabase">Add and configure ExportToDatabase<a class="anchor" aria-label="anchor" href="#add-and-configure-exporttodatabase"></a>
</h3>
<p>In CellProfiler, add:</p>
<p><strong>+ Add</strong> → <strong>File Processing</strong> →
<strong>ExportToDatabase</strong></p>
<p>Then adjust these settings:</p>
<ul>
<li>
<strong>Create a CellProfiler Analyst properties file?</strong> →
<code>Yes</code>
</li>
<li>
<strong>Which objects should be used for locations</strong> →
<code>Nuclei_Filtered</code>
</li>
<li>
<strong>Select the plate type</strong> → <code>384</code>
</li>
<li>
<strong>Sekect the plate metadata</strong> →
<code>Series</code>
</li>
<li>
<strong>Select the well metadata</strong> → <code>Well</code>
</li>
<li>
<strong>Output file location</strong> → (choose an output folder you
can find again)</li>
</ul>
<div id="challenge-add-exporttodatabase-and-generate-cpa-files" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="challenge-add-exporttodatabase-and-generate-cpa-files" class="callout-inner">
<h3 class="callout-title">Challenge: add ExportToDatabase and generate
CPA files</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Add <strong>ExportToDatabase</strong> to the end of your
pipeline.</li>
<li>Configure it to generate a CPA properties file.</li>
<li>Run your pipeline on a small subset of images.</li>
<li>Locate the exported database (<code>.db</code>) and the generated
properties file (<code>.properties</code>).</li>
</ol>
<p>Can you find both files on disk?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Solution (what you should see) </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>You should see a SQLite database file (<code>.db</code>) and a
<code>.properties</code> file in your chosen output folder. The
<code>.properties</code> file is what CPA opens.</p>
</div>
</div>
</div>
</div>
<div id="rough-edge-warning-object-relationships-can-break-cpa" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="rough-edge-warning-object-relationships-can-break-cpa" class="callout-inner">
<h3 class="callout-title">Rough edge warning: object relationships can
break CPA</h3>
<div class="callout-content">
<p>You may see a warning in <strong>ExportToDatabase</strong> along the
lines of:</p>
<blockquote>
<p>“Cytoplasm is not in a 1:1 relationship with the other objects”</p>
</blockquote>
<p>This typically happens when some objects were discarded (e.g. border
filtering) or when tertiary objects don’t perfectly mirror the matching
rules CPA expects across tables.</p>
<p>Fixing this properly often requires filtering or restructuring the
tables in SQLite/Python, which is beyond today’s workshop (see
below).</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="using-the-provided-database">Using the provided database<a class="anchor" aria-label="anchor" href="#using-the-provided-database"></a>
</h3>
<p>While you can use the database you create above, it will lead to some
issues in CellProfiler Analyst, because we removed cells touching the
image border.</p>
<p>Instead, use the provided database and, if you like, properties
file:</p>
<ul>
<li><code>data/analyst/DefaultDB.db</code></li>
<li><code>data/analyst/DefaultDB_MyExpt.properties</code></li>
</ul>
<p>If you generated your own properties file and want to reuse it, make
sure the database location inside it points to the database you are
using.</p>
<div id="if-cpa-cant-find-the-database" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="if-cpa-cant-find-the-database" class="callout-inner">
<h3 class="callout-title">If CPA can’t find the database</h3>
<div class="callout-content">
<p>Open <code>DefaultDB_MyExpt.properties</code> in a text editor and
update the database path line (line 10). Save the file and try
again.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="viewing-images-in-cellprofiler-analyst">Viewing images in CellProfiler Analyst<a class="anchor" aria-label="anchor" href="#viewing-images-in-cellprofiler-analyst"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="load-the-properties-file">Load the properties file<a class="anchor" aria-label="anchor" href="#load-the-properties-file"></a>
</h3>
<p>Open CPA and load the <code>.properties</code> file.</p>
<!-- slide 1 -->
<figure><img src="../fig/analyst/Slide1.png" alt="CellProfiler Analyst start screen indicating that a properties file must be loaded to begin." class="figure mx-auto d-block"></figure><!-- slide 2 --><figure><img src="../fig/analyst/Slide2.png" alt="File selection dialog in CellProfiler Analyst used to browse to and select a .properties file." class="figure mx-auto d-block"></figure><!-- slide 3 --><figure><img src="../fig/analyst/Slide3.png" alt="CellProfiler Analyst main window after loading a properties file, showing that the experiment is ready to browse." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="open-the-image-gallery-tool">Open the Image Gallery tool<a class="anchor" aria-label="anchor" href="#open-the-image-gallery-tool"></a>
</h3>
<p>In CPA, open the <strong>Image Gallery</strong>.</p>
<!-- slide 4 -->
<figure><img src="../fig/analyst/Slide4.png" alt="CellProfiler Analyst menu/navigation highlighting the Image Gallery tool." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="fetch-a-set-of-images">Fetch a set of images<a class="anchor" aria-label="anchor" href="#fetch-a-set-of-images"></a>
</h3>
<p>Click <strong>Fetch!</strong> to load thumbnails.</p>
<!-- slide 5 -->
<figure><img src="../fig/analyst/Slide5.png" alt="Image Gallery in CellProfiler Analyst with the Fetch button highlighted to load image thumbnails from the database." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="adjust-brightnesscontrast">Adjust brightness/contrast<a class="anchor" aria-label="anchor" href="#adjust-brightnesscontrast"></a>
</h3>
<p>In the top menu, open <strong>View → Image Controls</strong> and
increase brightness/contrast so cells are easier to see (e.g. ~150% as a
starting point).</p>
<!-- slide 6 -->
<figure><img src="../fig/analyst/Slide6.png" alt="Image Controls window in CellProfiler Analyst showing sliders for brightness/contrast adjustments." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="open-a-full-image">Open a full image<a class="anchor" aria-label="anchor" href="#open-a-full-image"></a>
</h3>
<p>Close the controls window, then double-click a thumbnail to open the
image.</p>
<!-- slide 7 -->
<figure><img src="../fig/analyst/Slide7.png" alt="CellProfiler Analyst showing a selected thumbnail in the Image Gallery ready to be opened by double-clicking." class="figure mx-auto d-block"></figure><p>When the image opens, CPA will assign colors to channels. You can
change which dye maps to which color using the channel controls at the
top.</p>
<p>Now examine what CPA is showing and how the channels are currently
colored.</p>
<!-- slide 8 -->
<figure><img src="../fig/analyst/Slide8.png" alt="Opened multi-channel microscopy image in CellProfiler Analyst with default color assignments and visible nuclei and cell bodies." class="figure mx-auto d-block"></figure><p>Change the channel colors by clicking the channel name/color
controls.</p>
<!-- slide 9 -->
<figure><img src="../fig/analyst/Slide9.png" alt="CellProfiler Analyst channel color controls highlighted, showing where to click to change channel-to-color mapping." class="figure mx-auto d-block"></figure><p>For this tutorial, map:</p>
<ul>
<li>DNA → <strong>blue</strong>
</li>
<li>Actin → <strong>green</strong>
</li>
<li>Tubulin → <strong>red</strong>
</li>
</ul>
<p>This is a basic overview of how you can quickly view images in
CellProfiler Analyst. Next, we will move on to a more important task:
classification.</p>
<!-- slide 10 -->
<figure><img src="../fig/analyst/Slide10.png" alt="Multi-channel image in CellProfiler Analyst after setting DNA to blue, actin to green, and tubulin to red." class="figure mx-auto d-block"></figure>
</div>
</section><section><h2 class="section-heading" id="classifying-cells-with-cellprofiler-analyst">Classifying cells with CellProfiler Analyst<a class="anchor" aria-label="anchor" href="#classifying-cells-with-cellprofiler-analyst"></a>
</h2>
<hr class="half-width">
<p>We will now train a simple two-class classifier. The exact labels are
arbitrary; the point is to learn the workflow and see how classification
quality depends on what examples you provide.</p>
<p>For this exercise, we will classify cells as healthy and
unhealthy.</p>
<div class="section level3">
<h3 id="open-the-classifier-tool">Open the Classifier tool<a class="anchor" aria-label="anchor" href="#open-the-classifier-tool"></a>
</h3>
<p>Open <strong>Classifier</strong> in CPA, then click
<strong>Fetch!</strong> to load cell thumbnails.</p>
<!-- slide 11 -->
<figure><img src="../fig/analyst/Slide11.png" alt="CellProfiler Analyst main window with the Classifier tool highlighted." class="figure mx-auto d-block"></figure><!-- slide 12 --><figure><img src="../fig/analyst/Slide12.png" alt="Classifier interface in CellProfiler Analyst showing the Fetch button used to load candidate cell thumbnails for training." class="figure mx-auto d-block"></figure><p>As before, you may need to re-adjust visibility via <strong>View →
Image Controls</strong>, and confirm your channel color mapping is still
sensible.</p>
</div>
<div class="section level3">
<h3 id="rename-classes">Rename classes<a class="anchor" aria-label="anchor" href="#rename-classes"></a>
</h3>
<p>By default, CPA shows “positive” and “negative”. Rename them:</p>
<ul>
<li>Right-click the black box under <strong>positive</strong> →
<em>Rename class</em> → <strong>Healthy</strong>
</li>
<li>Right-click the black box under <strong>negative</strong> →
<em>Rename class</em> → <strong>Unhealthy</strong>
</li>
</ul>
<!-- slide 13 --><figure><img src="../fig/analyst/Slide13.png" alt="Classifier training panel showing the default positive/negative classes and the option to rename them." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="label-training-examples">Label training examples<a class="anchor" aria-label="anchor" href="#label-training-examples"></a>
</h3>
<p>Now start sorting cells based on your judgement. You can
drag-and-drop thumbnails into a class, or:</p>
<ul>
<li>select a thumbnail and press <code>1</code> to assign
<strong>Healthy</strong>
</li>
<li>select a thumbnail and press <code>2</code> to assign
<strong>Unhealthy</strong>
</li>
</ul>
<p>Try to label at least ~20–50 examples total (more is better).</p>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>Agreeing on a definition on “healthy” and “unhealthy” will be
impossible here, but in a more realistic biological setup we might
identify, for example, rounded or elongated cells, which are more easily
distinguished visually.</p>
</div>
</div>
</div>
<p>You can already train the classifier at this step by clicking
<code>Train</code>, however, it will be biased towards features with
large numeric range.</p>
<!-- slide 14 -->
<figure><img src="../fig/analyst/Slide14.png" alt="CellProfiler Analyst classifier training view showing thumbnails being assigned to the Healthy and Unhealthy classes." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="enable-feature-scaling">Enable feature scaling<a class="anchor" aria-label="anchor" href="#enable-feature-scaling"></a>
</h3>
<p>To avoid features with large numeric ranges dominating the
classifier, enable scalar normalization:</p>
<p><code>Advanced &gt; Use Scalar</code></p>
<!-- slide 15 -->
<figure><img src="../fig/analyst/Slide15.png" alt="CellProfiler Analyst Advanced settings menu showing the Use Scalar option enabled for feature scaling." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="train-and-inspect-features">Train and inspect features<a class="anchor" aria-label="anchor" href="#train-and-inspect-features"></a>
</h3>
<p>Train the classifier (button name may be “Train”, or training may
happen automatically depending on your version/settings). CPA will show
which measured features it is using.</p>
<!-- slide 16 -->
<figure><img src="../fig/analyst/Slide16.png" alt="Classifier interface showing model training results and a ranked list of influential features used for classification." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="evaluate-the-classifier">Evaluate the classifier<a class="anchor" aria-label="anchor" href="#evaluate-the-classifier"></a>
</h3>
<p>Next, we wish to check what the classifier is detecting in our two
images. To do so, select:</p>
<p><code>Evaluation &gt; Classification Report</code></p>
<!-- slide 17 -->
<figure><img src="../fig/analyst/Slide17.png" alt="CellProfiler Analyst Evaluation menu with the Classification Report option highlighted." class="figure mx-auto d-block"></figure><p>Then click <strong>Evaluate</strong>.</p>
<!-- slide 18 -->
<figure><img src="../fig/analyst/Slide18.png" alt="Classifier evaluation panel with the Evaluate button highlighted to generate a classification report." class="figure mx-auto d-block"></figure><p>CPA will show a report with metrics such as precision, recall, and
F1.</p>
<ul>
<li>
<strong>Precision</strong>: of the cells predicted as Healthy, how
many were labeled Healthy?</li>
<li>
<strong>Recall</strong>: of the labeled Healthy cells, how many did
the classifier identify as sch?</li>
<li>
<strong>F1</strong>: a balanced score combining precision and recall
(useful when classes are imbalanced, like here)</li>
</ul>
<!-- slide 19 --><figure><img src="../fig/analyst/Slide19.png" alt="Classification report window showing metrics including precision, recall, and F1 score for Healthy and Unhealthy classes." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="score-all-images">Score all images<a class="anchor" aria-label="anchor" href="#score-all-images"></a>
</h3>
<p>As a further evaluation, we can predict phenotypes in all images
using <strong>Score All</strong>.</p>
<!-- slide 20 -->
<figure><img src="../fig/analyst/Slide20.png" alt="CellProfiler Analyst classifier interface with the Score All option highlighted to apply the classifier to all images." class="figure mx-auto d-block"></figure><p>CPA will produce a table summarizing class enrichment per
image/condition. In our dataset, you should see a trend consistent with
the experiment: well B02 (i.e. DMSO) is (non-significantly) enriched for
Healthy cells compared with cytoD-treated (B07) images.</p>
<!-- slide 21 -->
<figure><img src="../fig/analyst/Slide21.png" alt="Results table in CellProfiler Analyst showing per-image or per-condition counts/enrichment of Healthy versus Unhealthy classified cells." class="figure mx-auto d-block"></figure>
</div>
<div class="section level3">
<h3 id="refining-classifier">Refining classifier<a class="anchor" aria-label="anchor" href="#refining-classifier"></a>
</h3>
<p>To further improve the classifier, we can add label cells that the
classifier was uncertain about.</p>
<!-- slide 22 -->
<figure><img src="../fig/analyst/Slide22.png" alt="CellProfiler Analyst view with option to fetch uncertain predictions highlighted." class="figure mx-auto d-block"></figure><p>If we sort these images into the labels and then hit
<code>Train</code> again, we can get an increasingly accurate
classifier.</p>
</div>
</section><section><h2 class="section-heading" id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<hr class="half-width">
<p>You have now gone from segmentation and measurements (CellProfiler)
to <em>phenotype classification</em> (CellProfiler Analyst). This
workflow is powerful, but it only works well when:</p>
<ul>
<li>you have sufficiently descriptive features and</li>
<li>there is a visual phenotype.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>CellProfiler Analyst can classify cellular phenotypes using the
measurements exported by CellProfiler.</li>
<li>The <strong>properties file</strong> tells CPA how to find and
interpret your database and images.</li>
<li>
<strong>ExportToDatabase</strong> can generate CPA-ready outputs,
but database may need extra filtering.</li>
<li>Classifier performance depends heavily on consistent labels and
representative training examples.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
[pandoc]: https://pandoc.org/MANUAL.html
[r-markdown]: https://rmarkdown.rstudio.com/
[rstudio]: https://www.rstudio.com/
[carpentries-workbench]: https://carpentries.github.io/sandpaper-docs/
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/DBI-INFRA/2026-02-05-DCI-CellProfiler/" class="external-link">Source</a></p>
        <p>
        <a href="../citation.html">Cite</a>
        | <a href="mailto:jesko.wagner@sund.ku.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
		</div>
		<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.18.5" class="external-link">sandpaper (0.18.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/jeskowagner/varnish/tree/8da1eb456c7ff3588cefa7583bddc422ae83b3f8" class="external-link">varnish (1.0.9)</a></p>
		</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "CellProfiler, lesson, bioimaging",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/aio.html",
  "identifier": "https://DBI-INFRA.github.io/2026-02-05-DCI-CellProfiler/instructor/aio.html",
  "dateCreated": "2026-01-08",
  "dateModified": "2026-02-04",
  "datePublished": "2026-02-04"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

